<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript" src="biwascheme.js"> </script>
<script type="text/javascript" src="codemirror-compressed.js"></script>

<link rel="stylesheet" type="text/css" href="codemirror.css" />
<link rel="stylesheet" type="text/css" href="isicp.css" />
<title>iSICP</title>

</head>
<body>

<h1>Interactive SICP</h1>

<div id="sidebar">
  <form><textarea id="code" name="code"></textarea></form>
  <div id="eval"> eval </div>
  <div id="bs-console"></div>
</div>

<div id="main">

  <h2>Sample</h2>
  <div class="bs-snippet">(+ 1 2)</div><br>
  <div class="bs-snippet">(not #t) </div><br>
  <div class="bs-snippet">(boolean=? #t #t #t) </div><br>
  <div class="bs-snippet">;; length by Y combinator 
(((lambda (f) 
  ((lambda (proc) (f (lambda (arg) ((proc proc) arg))))
   (lambda (proc) (f (lambda (arg) ((proc proc) arg))))))
(lambda (self)
  (lambda (ls) 
    (if (null? ls) 0 (+ 1 (self (cdr ls))))))) 
'(1 2 3 4 5))</div><br>
      <div class="bs-snippet">;; length by Y combinator (tail recursive)
(((lambda (f)
((lambda (proc) (f (lambda (arg1 arg2) ((proc proc) arg1 arg2))))
   (lambda (proc) (f (lambda (arg1 arg2) ((proc proc) arg1 arg2))))))
(lambda (self) 
  (lambda (ls acc) 
    (if (null? ls) acc (self (cdr ls) (+ 1 acc))))))
'(1 2 3 4 5) 0)</div><br>
    </div>
  </td></tr></tbody></table>
</div>

<script type="text/javascript">
var on_error = function(e){
  puts(e.message);
  throw(e);
};
var biwascheme = new BiwaScheme.Interpreter(on_error);

var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
});

$("#eval").click(function(){
  $("#bs-console").empty();
  var str = editor.getValue();
  biwascheme.evaluate(str, function(result){
    puts(BiwaScheme.to_write(result));
  });
});

$(".bs-snippet").click(function(e){
  editor.setValue($(this).html());
});
</script>
</body>
</html>
